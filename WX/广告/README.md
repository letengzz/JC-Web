# 添加广告

![image-20220504145238032](D:/Data/typora/photo/image-20220504145238032.png)

微信小程序里面的广告目前已经支持多种形式 包括Banner广告 视频广告 视频激励广告 封面广告格子广告

视频贴片广告 插屏广告等形式 几乎所有常见的广告形式目前在微信小程序里面 都获得了支持 除了微信支付

以外 广告是小程序开发者变现的主要形式 并且这种形式对于企业账号 个人账号都是开放的

在小程序里面置入广告 首先需要开通流量主 

目前小程序开通流量主的门槛并不高 开通条件是累计独立访客达到1000以上

在开通流量主以后 登录小程序后台创建广告获取代码 就可以在小程序里面展示广告了

每个广告都有一个独立的ID 这个ID是广告本身的一个身份 

有一些早期的个人小程序产品 是由第三方企业代为创建和开发的  广告收入按理说应该归个人所有

这种场景微信团队目前也考虑到了

在小程序的后台流量主 财务管理这个页面里面 企业账号可以设置 由个人银行账号 代收广告的费用

按页面中的提示 就可以完成操作 使用企业账号但不使用官方支付功能的个人小程序运营者 提供了以广告盈利的一个便利性

![image-20220504150216516](D:/Data/typora/photo/image-20220504150216516.png)

Banner广告是最早启用的微信小广告的一个形式 登录小程序的后台 在流量主广告管理这个页面里面 选择第一个tab类型 就可以快速的创建一个Banner广告了 无需其他的一些配置 查看广告的代码 在小程序里面 插入对应的广告代码 广告就可以显示了 

广告的测试 在微信开发者工具里面 也可以完成 不需要借助手机



如何创建与展示一个Banner广告

![image-20220504150555745](D:/Data/typora/photo/image-20220504150555745.png)

首先我们扫码 登录小程序的账号后台 登录之后 找到流量主推广 

如果没有开通流量主 第一步 他会提示你开通 

然后在开通以后 

![image-20220504150728931](D:/Data/typora/photo/image-20220504150728931.png)

![image-20220504150735041](D:/Data/typora/photo/image-20220504150735041.png)

单击广告管理 

广告管理下面可以看到广告位的管理 有很多类型的广告 

![image-20220504150836372](D:/Data/typora/photo/image-20220504150836372.png)

第一个就是Banner广告 这也是最早的广告类型之一 

单击右边的新建广告位按钮

![image-20220504150937389](D:/Data/typora/photo/image-20220504150937389.png)

选择广告类型：Banner广告 填写完名称 就可以创建了

这个Banner广告不需要其他的一些参数配置 它本身其实只是生成了唯一的广告ID

创建之后点击获取代码 将代码copy一下

然后进入微信开发者程序 将广告

放入到WXML中



财务管理 

![image-20220504151330952](D:/Data/typora/photo/image-20220504151330952.png)

![image-20220504151347599](D:/Data/typora/photo/image-20220504151347599.png)

单击财务信息的立即完善

![image-20220504151418978](D:/Data/typora/photo/image-20220504151418978.png)

目前收款也允许企业类型的流量主 委托个人收款 

![image-20220504151510651](D:/Data/typora/photo/image-20220504151510651.png)

要下载模板 然后写一个文档 然后拍照上传 传完之后这个配置就可以完成了



## 视频激励广告

视频激励广告是继Banner广告以后 第二个可以在微信小程序里面 使用的广告类型 

有的用户想体验产品的付费功能 但又不愿意花钱购买 这个时候开发者可以要求用户观看一段视频激励广告

用户付出时间 获取体验付费功能的权限 开发者拿取一个广告费 各取所需

从广告的形式上来看 视频激励广告 它是一种全屏广告 允许开发者监听视频广告播放的结束状态

如果用户看完了广告 给予用户一定的激励 如果是没看完的话 就不给激励

具体的激励类型可以是游戏的道具 可以兑换商品的积分等等 如果用户没有看完 系统还会给用户一个是否继续观看的提示  默认状态下 视频激励广告是隐藏的 需要手动调用show方法进行显示

和所有广告一样 视频激励广告也有可能会显示失败 这个时候可以重新调用load方法重新拉取 在拉取成功以后

再度调用show方法进行展示 通过onLoad onError onClose 添加的事件回调 在多次尝试加载时 并不需要重复设置监听 通常只需要设置一次就可以了 

 如何创建和使用视频激励广告

首先登录小程序管理后台

![image-20220504174851022](D:/Data/typora/photo/image-20220504174851022.png)

找到推广下面的流量主

选择广告管理

然后选择新建广告位

广告类型选择激励式广告

还可以设置广告展示时间

点击获取代码 copy到项目里面 进行修改和使用

在WXML中 

![image-20220504175354651](D:/Data/typora/photo/image-20220504175354651.png)

在JS中 

![image-20220504175412812](D:/Data/typora/photo/image-20220504175412812.png)

第一步通过showModal这个接口去展示一个模式弹窗

if如果同意的 就可以用createRewardedVideoAd创建一个视频激励广告

它有三个监听 onLoad代表的是加载完成 onError代表出现错误 onClose是必不可少的一个监听 

它代表的是监听这个广告关闭 关闭有两种情况 如果看完这个res它有一个isEnded这样一个属性

如果为true 代表用户正常看完广告 这个时候可以在分支里面 去给予用户正常的奖励

如果没有看完 可以有一些其他处理

下面还有一个show 它是对广告对象的show调用

调用它里面有一个catch 代表的是去捕捉它的一个异常错误 如果捕捉到异常之后

再尝试调用它load方法 然后再进行一个show的展示

因为在很多情况下 视频激励广告 可能会加载失败 而有时候我们确实需要去展示这个广告 让用户去获取奖励

![image-20220504175758058](D:/Data/typora/photo/image-20220504175758058.png)

![image-20220504181133904](D:/Data/typora/photo/image-20220504181133904.png)

而三个回调的监听 onLoad onError onClose 它在调用完设置完以后 它不需要重复的去设置 

对应的onLoad它还有一个videoAd.offLoad方法

![image-20220504181647929](D:/Data/typora/photo/image-20220504181647929.png)

前面的方法代表的是添加一个回调 后面这个offLoad 代表移除监听

因为针对的都是同一对象所以即使在重新加载和展示的时候 ![image-20220504181811664](D:/Data/typora/photo/image-20220504181811664.png)这些设置也不需要重复添加 只需要设置一次就可以了 

![image-20220504181942219](D:/Data/typora/photo/image-20220504181942219.png)

拿到了播放关闭 拿到isEnded就等于true 这个时候就可以把奖励奖励给当前用户

## 封面广告与自定义模板广告

与打开京东腾讯视频等大厂的APP看到的广告一样 封面广告它是进入小程序的时候 在加载小程序页面之前

展示的一种广告 目前仅支持从微信主界面下拉菜单进入小程序的时候展示 从群内分享的一个小卡片打开 是没有封面广告展示的  在封面广告右下角 有一个跳过 可以单击跳过这个广告 左上角展示这个广告的剩余时间 这个广告不需要开发 也不需要创建 在小程序的后台 它直接是一个CheckBox的开关 只需要单击开启 就可以了



原生模板广告

这种广告允许我们 自定义广告展示的样式和位置 广告数据仍然是来自微信 这种方式给予用户很大的自由 可以在特定的场景里面 展示特定风格的广告 包括它的大小也是可以控制的 以这样达到更好的广告效果

使用自定义模板广告有两种方式：一种是用WXML代码 另一种是使用JS代码直接创建 使用代码控制自定义模板广告的时候 将参数fixed可以设置true 可以控制广告全屏 

使用WXML标签 代码控制自定义模板广告的时候与其他WXML组件是一样的 可以通过WXSS样式 控制自定义模板广告的大小以及位置 

**注意**：在微信开发者工具里面 测试自定义模板广告的时候 可能会渲染失败 可以多尝试几次 尤其是以JS代码创建的

自定义模板广告 

整体来讲 使用代码控制自定义广告 它不仅样式不好控制 并且失败率也很高 最好是使用WXML组件 加条件渲染这样一种方式 然后进行展示广告 这样简单方便 并且渲染吗的失败率还很低 

如何创建和使用自定义的模板广告

![image-20220504193611811](D:/Data/typora/photo/image-20220504193611811.png)

首先打开小程序的管理后台 登录以后找到流量主和广告管理

封面广告不需要开发 因为对于每个小程序它只有一种 也就是进入的时候展示的封面广告 所以只需要将开关打开 然后他自动在小程序加载的时候 展示这个封面广告 其他就不需要管了 



接下来看一下原生模板广告 

和其他广告一样在使用之前仍然需要创建 单击创建按钮 创建  创建完成以后 点击编辑

![image-20220504194010028](D:/Data/typora/photo/image-20220504194010028.png)

![image-20220504194019949](D:/Data/typora/photo/image-20220504194019949.png)

有全屏 比例等 

原生模板广告在默认的提供的模板类型里面 它吧我们前面用的格子广告 Banner广告等所有形式 都全部模拟了

用原生模板广告可以更加灵活地实现多种的一种方式



编辑完成之后就点击获取代码 这个代码是用WXML代码去展示模板广告的 除了这种方法以外 还可以通过查看文档

![image-20220504194418349](D:/Data/typora/photo/image-20220504194418349.png)

文档里面藐视了如何用JS去创建和展示这种广告 

![image-20220504194507445](D:/Data/typora/photo/image-20220504194507445.png)

![image-20220504194523257](D:/Data/typora/photo/image-20220504194523257.png)

两个按钮 一个自定义模板广告  这个ad-custom代表的是自定义模板广告的这样一个组件 

![image-20220504194650958](D:/Data/typora/photo/image-20220504194650958.png)

然后对应的还有两个JS函数

![image-20220504194726104](D:/Data/typora/photo/image-20220504194726104.png)

![image-20220504194739404](D:/Data/typora/photo/image-20220504194739404.png)

![image-20220504194746684](D:/Data/typora/photo/image-20220504194746684.png)

![image-20220504194752975](D:/Data/typora/photo/image-20220504194752975.png)

js函数也要copy



自定义广告1 他调用的方法

![image-20220504194846097](D:/Data/typora/photo/image-20220504194846097.png)

首先是判断customAd是否是创建过 如果创建过 进行调用它的一个销毁 为了防止多次单击 进行重复创建的一种情况

接下来通过 createCustomAd去创建自定义模板广告 这里面有一个adUnitld这个就是每个广告唯一的ID

下面还有一个style 为了设置我们 以代码然后创建的时候设置自定义模板广告它的一个样式 主要是它的一个位置

将fixed设置为true的时候 它代表是将广告进行全屏 接下来设置它的回调 

![image-20220504195411835](D:/Data/typora/photo/image-20220504195411835.png)

跟前面监听视频激励广告一样 

最后一步就是调用show方法 进行展示 这个是必不可少的 因为它默认是不展示的

我们需要显示的去调用这个方法 将它展示出来 



第二个按钮显示自定义广告2

![image-20220504195602984](D:/Data/typora/photo/image-20220504195602984.png)

这个方法其实是设置了shiowCustomAd这样的一个页面的一个变量 变量有一个切换 

拿这个变量去控制ad-custom它的一个展示与不展示 

![image-20220504195715623](D:/Data/typora/photo/image-20220504195715623.png)

所以基本上已经明确了我们这里面有两种方式 一种就是我们是这种第一个 这种方法是我们用WXML 用组件的方式去展示自定义模板广告 、

而下面这个用代码 用JS展示自定义模板广告

注意第一种需要样式 设置宽高否则显示不全![image-20220504200350884](D:/Data/typora/photo/image-20220504200350884.png)



另外一种方式 ：使用代码创建广告并展示(自定义广告2) 使用JS创建自定义模板广告的时候 有很大的几率失败



比较好的一种策略就是我们用组件 



![image-20220504200629189](D:/Data/typora/photo/image-20220504200629189.png)

预先定义这个广告组件 然后控制它的一个显示 这种方式失败率没有那么高 



除了以上方式外还有插屏广告 视频贴片广告 格子广告等等 这些广告形式在使用上 是大同小异的

对于不想看广告的用户最好提供VIP免广告这样的一种功能

即使是个人开发者也能实现VIP免广告的功能  广告是一种即时展示的资源  并不是说想展示就能展示的

广告在展示的时候 它有一定的失败率 失败率是设计小程序的时候 应该从产品角度 应该考虑的问题 在渲染失败的时候 可以选择重试 也可以选择放弃本次展示  每个广告都有一个唯一的ID 如果我们想动态地控制广告的展示 只需要将这个广告ID 存储在数据库里面 在小程序中动态地拉取出来 然后在渲染